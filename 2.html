<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bootstrap 5 Conversion</title>
    <!-- Bootstrap 5 CSS -->
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/5.1.3/css/bootstrap.min.css" rel="stylesheet">
    <!-- Custom CSS -->
    <style>
        h1 {
            margin-bottom: 20px;
        }

        .chart {
            margin-bottom: 40px;
        }

        .chart h2 {
            margin-bottom: 10px;
        }

        .bars {
            display: flex;
            flex-direction: column;
        }

        .bar {
            position: relative;
            margin: 5px 0;
            border-radius: 4px;
            height: 40px; /* Increased height for longer bars */
            transition: background-color 0.3s, width 1s; /* Smooth transition for dynamic effect */
            width: 0; /* Start with width 0 for dynamic effect */
            background-color: #fae099; /* Default color */
        }

        .bar[data-max="true"] {
            background-color: #f89b9b; /* Highlight color for max value (lighter) */
        }

        .bar[data-min="true"] {
            background-color: #c3ffb3; /* Highlight color for min value (lighter) */
        }

        .bar::after {
            content: attr(data-country) ": " attr(data-value) " 台幣元/度";
            position: absolute;
            left: 10px;
            top: 50%;
            transform: translateY(-50%);
            color: #212529; /* Specified font color */
            font-size: 14px;
            white-space: nowrap; /* Prevent text from wrapping */
            overflow: visible; /* Allow text to extend beyond the bar */
        }
    </style>
</head>
<body>
    <div class="container data-section" data-aos="fade-up" data-aos-delay="100">
        <h3 data-aos="fade-up" data-aos-delay="100">2022各國電價比較</h3>
        <div class="chart" id="residentialChart" data-aos="fade-up" data-aos-delay="100">
            <h4 data-aos="fade-up" data-aos-delay="100">住宅用電價格</h4>
            <div class="bars"></div>
        </div>
        <div class="chart" id="industrialChart" data-aos="fade-up" data-aos-delay="100">
            <h4 data-aos="fade-up" data-aos-delay="100">工業用電價格</h4>
            <div class="bars"></div>
        </div>
    </div>
    
    <!-- jQuery (optional, if needed) -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <!-- Bootstrap 5 JS bundle -->
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/5.1.3/js/bootstrap.bundle.min.js"></script>
    <!-- Custom JS -->
    <script >
		document.addEventListener('DOMContentLoaded', function () {
    const residentialData = [
        { country: "馬來西亞", value: 1.4888 },
        { country: "中國", value: 2.4238 },
        { country: "墨西哥", value: 2.6204 },
        { country: "土耳其", value: 2.6655 },
        { country: "台灣", value: 2.6849 },
        { country: "南韓", value: 3.1806 },
        { country: "泰國", value: 3.6626 },
        { country: "加拿大", value: 3.7198 },
        { country: "美國", value: 4.5034 }, 
        { country: "澳洲", value: 5.9554 },
        { country: "日本", value: 7.8372 },
        { country: "法國", value: 8.3919 },
        // ... add remaining data
    ];

    const industrialData = [
        { country: "馬來西亞", value: 2.2928 },
        { country: "美國", value: 2.5175 },
        { country: "台灣", value: 2.7624 },
        { country: "加拿大", value: 2.7992 },
        { country: "中國", value: 2.8139 },
        { country: "南韓", value: 2.8372 },
        { country: "泰國", value: 2.9479 },
        { country: "法國", value: 4.0830 },
        { country: "澳洲", value: 4.7643 },
        { country: "日本", value: 5.2965 },
        // ... add remaining data
    ];

    const maxResidentialValue = Math.max(...residentialData.map(d => d.value));
    const minResidentialValue = Math.min(...residentialData.map(d => d.value));
    const maxIndustrialValue = Math.max(...industrialData.map(d => d.value));
    const minIndustrialValue = Math.min(...industrialData.map(d => d.value));

    createBars(residentialData, 'residentialChart', maxResidentialValue, minResidentialValue);
    createBars(industrialData, 'industrialChart', maxIndustrialValue, minIndustrialValue);

    const observer = new IntersectionObserver(animateBars, { threshold: 0.1 });
    document.querySelectorAll('.chart').forEach(chart => {
        chart.dataset.maxValue = Math.max(...Array.from(chart.querySelectorAll('.bar')).map(bar => parseFloat(bar.getAttribute('data-value'))));
        observer.observe(chart);
    });
});

function createBars(data, containerId, maxValue, minValue) {
    const container = document.getElementById(containerId).querySelector('.bars');
    data.forEach(item => {
        const bar = document.createElement('div');
        bar.className = 'bar';
        if (item.value === maxValue) {
            bar.setAttribute('data-max', 'true'); // Highlight max value
        } else if (item.value === minValue) {
            bar.setAttribute('data-min', 'true'); // Highlight min value
        }
        bar.setAttribute('data-country', item.country);
        bar.setAttribute('data-value', item.value);
        bar.style.width = 0; // Start with width 0 for dynamic effect
        container.appendChild(bar);
    });
}

function animateBars(entries, observer) {
    entries.forEach(entry => {
        if (entry.isIntersecting) {
            const bars = entry.target.querySelectorAll('.bar');
            bars.forEach(bar => {
                bar.style.width = (bar.getAttribute('data-value') / entry.target.dataset.maxValue * 100) + '%'; // Adjust the width based on the max value
            });
            observer.unobserve(entry.target); // Stop observing once the animation is done
        }
    });
}

	</script>
</body>
</html>
